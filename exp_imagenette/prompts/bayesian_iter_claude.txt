The goal is to come up with a concept bottleneck model that only extracts {num_concepts} meta-concepts to describe attributes in an image to predict some label Y with maximum accuracy. A meta-concept is a binary feature extractor defined by a yes/no question. We have {num_concepts_fixed} meta-concepts so far:
{meta_concepts}

To come up with candidates for the {num_concepts}th meta-concept, I have done the following: I first fit a CBM on the {num_concepts_fixed} existing meta-concepts. Then to figure out how to improve this {num_concepts_fixed}-concept CBM, I first asked an LLM to extract a list of attributes that are present in each image, and then fit a linear regression model on the extracted attributes to predict the residuals of the {num_concepts_fixed}-concept CBM. These are the top extracted attributes in the resulting residual model, in descending order of importance:

{top_features_df}

Given the residual model, create cohesive candidates for the {num_concepts}th meta-concept. Be systematic by working through ALL {num_attributes} attributes in the residual model one by one, starting from the most to the least predictive. For each attribute, check if it matches an existing meta-concept or create a new candidate meta-concept. All attributes should correspond to at least one candidate. Work down the list, iterating through each attribute. Clearly state each candidate meta-concept as a yes/no question.

Suggestions for generating candidate meta-concepts: Do not propose meta-concepts that are simply a union of two different concepts (e.g. "Does this image contain hands or fur?" is not allowed) or questions with answers that are almost always a yes (e.g. the answer to "Does this image contain a background?" is almost always yes, and so should be excluded). Do not propose meta-concepts where you would expect over 95% agreement or disagreement with the {num_concepts_fixed} existing meta-concepts (e.g. "Does the image show a fluffy dog?" overlaps too much with "Does the image show a furry dog?").

Output at least 6 candidate concepts in the following JSON format:
{
    "reasoning": "<DISCUSS REASONING FOR WHICH CONCEPTS TO INCLUDE>",
    "concepts": [
        {"concept": "<CANDIDATE META CONCEPT>", "words": <COMMA-SEPARATED WORDS THAT ARE CLOSE SYNONYMS OR ANTONYMS OF THIS CONCEPT>},
        ...
    ]
}
Here are example concept dictionaries:
[
    {"concept": "Does the image depict blue feathers?", "words": "blue feathers, blue plumage"},
    {"concept": "Does the image depict a fur?", "words": "fur, furry"},
    ...
]